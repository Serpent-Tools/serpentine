import "./lib.snek" as lib;

export tests = lib::rust
    > lib::Cooked("--tests")
    > lib::Binstall("cargo-nextest", "cargo-nextest")
    > Exec("RUST_LOG='serpentine=trace' cargo nextest run --frozen");

export update_snapshot = lib::rust
    > lib::Cooked("--tests")
    > lib::Binstall("cargo-insta", "cargo-insta")
    > Exec("cargo insta test --accept --unreferenced delete")
    > Export("./serpentine/src")
    > ToHost("./serpentine/src");
